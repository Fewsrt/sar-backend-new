/*
  Warnings:

  - You are about to drop the column `approval_amount` on the `car` table. All the data in the column will be lost.
  - You are about to drop the column `approval_date` on the `car` table. All the data in the column will be lost.
  - You are about to drop the column `approval_order` on the `car` table. All the data in the column will be lost.
  - You are about to drop the column `approval_status` on the `car` table. All the data in the column will be lost.
  - You are about to drop the column `body_repair` on the `car` table. All the data in the column will be lost.
  - You are about to drop the column `book_close_date` on the `car` table. All the data in the column will be lost.
  - You are about to drop the column `book_record_date` on the `car` table. All the data in the column will be lost.
  - You are about to drop the column `book_sent_to_bank_date` on the `car` table. All the data in the column will be lost.
  - You are about to drop the column `booked_date` on the `car` table. All the data in the column will be lost.
  - You are about to drop the column `booked_status` on the `car` table. All the data in the column will be lost.
  - You are about to drop the column `branch_50_percent_id` on the `car` table. All the data in the column will be lost.
  - You are about to drop the column `car_commission` on the `car` table. All the data in the column will be lost.
  - You are about to drop the column `car_image_link` on the `car` table. All the data in the column will be lost.
  - You are about to drop the column `car_release_date` on the `car` table. All the data in the column will be lost.
  - You are about to drop the column `cash_back` on the `car` table. All the data in the column will be lost.
  - You are about to drop the column `customer_id` on the `car` table. All the data in the column will be lost.
  - You are about to drop the column `day` on the `car` table. All the data in the column will be lost.
  - You are about to drop the column `down_payment` on the `car` table. All the data in the column will be lost.
  - You are about to drop the column `expected_income` on the `car` table. All the data in the column will be lost.
  - You are about to drop the column `expected_profit` on the `car` table. All the data in the column will be lost.
  - You are about to drop the column `film_radio` on the `car` table. All the data in the column will be lost.
  - You are about to drop the column `final_profit` on the `car` table. All the data in the column will be lost.
  - You are about to drop the column `financing_id` on the `car` table. All the data in the column will be lost.
  - You are about to drop the column `fp_due_date` on the `car` table. All the data in the column will be lost.
  - You are about to drop the column `fp_name` on the `car` table. All the data in the column will be lost.
  - You are about to drop the column `fuel_cost` on the `car` table. All the data in the column will be lost.
  - You are about to drop the column `gross_profit` on the `car` table. All the data in the column will be lost.
  - You are about to drop the column `installment_amount` on the `car` table. All the data in the column will be lost.
  - You are about to drop the column `installment_number` on the `car` table. All the data in the column will be lost.
  - You are about to drop the column `installment_support` on the `car` table. All the data in the column will be lost.
  - You are about to drop the column `interest_fp` on the `car` table. All the data in the column will be lost.
  - You are about to drop the column `month` on the `car` table. All the data in the column will be lost.
  - You are about to drop the column `net_cost` on the `car` table. All the data in the column will be lost.
  - You are about to drop the column `new_tires` on the `car` table. All the data in the column will be lost.
  - You are about to drop the column `note` on the `car` table. All the data in the column will be lost.
  - You are about to drop the column `operation_cost` on the `car` table. All the data in the column will be lost.
  - You are about to drop the column `other_expenses` on the `car` table. All the data in the column will be lost.
  - You are about to drop the column `other_promotions` on the `car` table. All the data in the column will be lost.
  - You are about to drop the column `paid_difference` on the `car` table. All the data in the column will be lost.
  - You are about to drop the column `parking_id` on the `car` table. All the data in the column will be lost.
  - You are about to drop the column `payment_date` on the `car` table. All the data in the column will be lost.
  - You are about to drop the column `payment_order` on the `car` table. All the data in the column will be lost.
  - You are about to drop the column `payment_status` on the `car` table. All the data in the column will be lost.
  - You are about to drop the column `promotion_detail` on the `car` table. All the data in the column will be lost.
  - You are about to drop the column `purchase_from_id` on the `car` table. All the data in the column will be lost.
  - You are about to drop the column `purchase_price` on the `car` table. All the data in the column will be lost.
  - You are about to drop the column `referral_fee` on the `car` table. All the data in the column will be lost.
  - You are about to drop the column `remaining_loan` on the `car` table. All the data in the column will be lost.
  - You are about to drop the column `sale_branch_id` on the `car` table. All the data in the column will be lost.
  - You are about to drop the column `sale_price` on the `car` table. All the data in the column will be lost.
  - You are about to drop the column `sales_commission` on the `car` table. All the data in the column will be lost.
  - You are about to drop the column `salesperson_id` on the `car` table. All the data in the column will be lost.
  - You are about to drop the column `seat_upholstery` on the `car` table. All the data in the column will be lost.
  - You are about to drop the column `service_cost` on the `car` table. All the data in the column will be lost.
  - You are about to drop the column `tax_invoice_sale_date` on the `car` table. All the data in the column will be lost.
  - You are about to drop the column `tax_transfer` on the `car` table. All the data in the column will be lost.
  - You are about to drop the column `total_expenses` on the `car` table. All the data in the column will be lost.
  - You are about to drop the column `total_income` on the `car` table. All the data in the column will be lost.
  - You are about to drop the column `total_promotion_expenses` on the `car` table. All the data in the column will be lost.
  - You are about to drop the column `total_purchase_price` on the `car` table. All the data in the column will be lost.
  - You are about to drop the column `total_revenue` on the `car` table. All the data in the column will be lost.
  - You are about to drop the column `tracking_note` on the `car` table. All the data in the column will be lost.
  - You are about to drop the column `trailer_cost` on the `car` table. All the data in the column will be lost.
  - You are about to drop the column `transfer_finance` on the `car` table. All the data in the column will be lost.
  - You are about to drop the column `transfer_status` on the `car` table. All the data in the column will be lost.
  - You are about to drop the column `year` on the `car` table. All the data in the column will be lost.
  - You are about to drop the column `car_id` on the `purchaseTaxInvoice` table. All the data in the column will be lost.
  - You are about to drop the column `car_id` on the `taxInvoice` table. All the data in the column will be lost.
  - You are about to drop the column `car_id` on the `withholdingTaxInvoice` table. All the data in the column will be lost.

*/
-- DropForeignKey
ALTER TABLE "car" DROP CONSTRAINT "car_branch_50_percent_id_fkey";

-- DropForeignKey
ALTER TABLE "car" DROP CONSTRAINT "car_customer_id_fkey";

-- DropForeignKey
ALTER TABLE "car" DROP CONSTRAINT "car_financing_id_fkey";

-- DropForeignKey
ALTER TABLE "car" DROP CONSTRAINT "car_parking_id_fkey";

-- DropForeignKey
ALTER TABLE "car" DROP CONSTRAINT "car_purchase_from_id_fkey";

-- DropForeignKey
ALTER TABLE "car" DROP CONSTRAINT "car_sale_branch_id_fkey";

-- DropForeignKey
ALTER TABLE "car" DROP CONSTRAINT "car_salesperson_id_fkey";

-- DropForeignKey
ALTER TABLE "purchaseTaxInvoice" DROP CONSTRAINT "purchaseTaxInvoice_car_id_fkey";

-- DropForeignKey
ALTER TABLE "taxInvoice" DROP CONSTRAINT "taxInvoice_car_id_fkey";

-- DropForeignKey
ALTER TABLE "withholdingTaxInvoice" DROP CONSTRAINT "withholdingTaxInvoice_car_id_fkey";

-- DropIndex
DROP INDEX "car_customer_id_idx";

-- AlterTable
ALTER TABLE "car" DROP COLUMN "approval_amount",
DROP COLUMN "approval_date",
DROP COLUMN "approval_order",
DROP COLUMN "approval_status",
DROP COLUMN "body_repair",
DROP COLUMN "book_close_date",
DROP COLUMN "book_record_date",
DROP COLUMN "book_sent_to_bank_date",
DROP COLUMN "booked_date",
DROP COLUMN "booked_status",
DROP COLUMN "branch_50_percent_id",
DROP COLUMN "car_commission",
DROP COLUMN "car_image_link",
DROP COLUMN "car_release_date",
DROP COLUMN "cash_back",
DROP COLUMN "customer_id",
DROP COLUMN "day",
DROP COLUMN "down_payment",
DROP COLUMN "expected_income",
DROP COLUMN "expected_profit",
DROP COLUMN "film_radio",
DROP COLUMN "final_profit",
DROP COLUMN "financing_id",
DROP COLUMN "fp_due_date",
DROP COLUMN "fp_name",
DROP COLUMN "fuel_cost",
DROP COLUMN "gross_profit",
DROP COLUMN "installment_amount",
DROP COLUMN "installment_number",
DROP COLUMN "installment_support",
DROP COLUMN "interest_fp",
DROP COLUMN "month",
DROP COLUMN "net_cost",
DROP COLUMN "new_tires",
DROP COLUMN "note",
DROP COLUMN "operation_cost",
DROP COLUMN "other_expenses",
DROP COLUMN "other_promotions",
DROP COLUMN "paid_difference",
DROP COLUMN "parking_id",
DROP COLUMN "payment_date",
DROP COLUMN "payment_order",
DROP COLUMN "payment_status",
DROP COLUMN "promotion_detail",
DROP COLUMN "purchase_from_id",
DROP COLUMN "purchase_price",
DROP COLUMN "referral_fee",
DROP COLUMN "remaining_loan",
DROP COLUMN "sale_branch_id",
DROP COLUMN "sale_price",
DROP COLUMN "sales_commission",
DROP COLUMN "salesperson_id",
DROP COLUMN "seat_upholstery",
DROP COLUMN "service_cost",
DROP COLUMN "tax_invoice_sale_date",
DROP COLUMN "tax_transfer",
DROP COLUMN "total_expenses",
DROP COLUMN "total_income",
DROP COLUMN "total_promotion_expenses",
DROP COLUMN "total_purchase_price",
DROP COLUMN "total_revenue",
DROP COLUMN "tracking_note",
DROP COLUMN "trailer_cost",
DROP COLUMN "transfer_finance",
DROP COLUMN "transfer_status",
DROP COLUMN "year";

-- AlterTable
ALTER TABLE "purchaseTaxInvoice" DROP COLUMN "car_id";

-- AlterTable
ALTER TABLE "taxInvoice" DROP COLUMN "car_id";

-- AlterTable
ALTER TABLE "withholdingTaxInvoice" DROP COLUMN "car_id";

-- CreateTable
CREATE TABLE "carFinancialDetails" (
    "id" SERIAL NOT NULL,
    "car_id" INTEGER NOT NULL,
    "sale_price" DOUBLE PRECISION,
    "net_cost" DOUBLE PRECISION,
    "gross_profit" DOUBLE PRECISION,
    "purchase_price" DOUBLE PRECISION,
    "operation_cost" DOUBLE PRECISION,
    "total_purchase_price" DOUBLE PRECISION,
    "remaining_loan" DOUBLE PRECISION,
    "paid_difference" DOUBLE PRECISION,
    "total_income" DOUBLE PRECISION,
    "transfer_finance" DOUBLE PRECISION,
    "car_commission" DOUBLE PRECISION,
    "down_payment" DOUBLE PRECISION,
    "total_revenue" DOUBLE PRECISION,
    "approval_amount" DOUBLE PRECISION,
    "expected_income" DOUBLE PRECISION,
    "expected_profit" DOUBLE PRECISION,
    "created_at" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "updated_at" TIMESTAMP(3) NOT NULL,
    "deleted_at" TIMESTAMP(3),

    CONSTRAINT "carFinancialDetails_pkey" PRIMARY KEY ("id")
);

-- CreateTable
CREATE TABLE "carExpenseDetails" (
    "id" SERIAL NOT NULL,
    "car_id" INTEGER NOT NULL,
    "interest_fp" DOUBLE PRECISION,
    "body_repair" DOUBLE PRECISION,
    "service_cost" DOUBLE PRECISION,
    "film_radio" DOUBLE PRECISION,
    "seat_upholstery" DOUBLE PRECISION,
    "tax_transfer" DOUBLE PRECISION,
    "sales_commission" DOUBLE PRECISION,
    "fuel_cost" DOUBLE PRECISION,
    "referral_fee" DOUBLE PRECISION,
    "trailer_cost" DOUBLE PRECISION,
    "other_expenses" DOUBLE PRECISION,
    "new_tires" DOUBLE PRECISION,
    "installment_support" DOUBLE PRECISION,
    "cash_back" DOUBLE PRECISION,
    "other_promotions" TEXT,
    "total_promotion_expenses" DOUBLE PRECISION,
    "final_profit" DOUBLE PRECISION,
    "total_expenses" DOUBLE PRECISION,
    "created_at" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "updated_at" TIMESTAMP(3) NOT NULL,
    "deleted_at" TIMESTAMP(3),

    CONSTRAINT "carExpenseDetails_pkey" PRIMARY KEY ("id")
);

-- CreateTable
CREATE TABLE "carApprovalDetails" (
    "id" SERIAL NOT NULL,
    "car_id" INTEGER NOT NULL,
    "approval_status" BOOLEAN DEFAULT false,
    "booked_status" BOOLEAN DEFAULT false,
    "payment_status" BOOLEAN DEFAULT false,
    "approval_order" INTEGER,
    "payment_order" INTEGER,
    "approval_date" TIMESTAMP(3),
    "booked_date" TIMESTAMP(3),
    "payment_date" TIMESTAMP(3),
    "created_at" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "updated_at" TIMESTAMP(3) NOT NULL,
    "deleted_at" TIMESTAMP(3),

    CONSTRAINT "carApprovalDetails_pkey" PRIMARY KEY ("id")
);

-- CreateTable
CREATE TABLE "carLocationDetails" (
    "id" SERIAL NOT NULL,
    "car_id" INTEGER NOT NULL,
    "parking_id" INTEGER NOT NULL,
    "sale_branch_id" INTEGER,
    "branch_50_percent_id" INTEGER,
    "created_at" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "updated_at" TIMESTAMP(3) NOT NULL,
    "deleted_at" TIMESTAMP(3),

    CONSTRAINT "carLocationDetails_pkey" PRIMARY KEY ("id")
);

-- CreateTable
CREATE TABLE "carTaxDetails" (
    "id" SERIAL NOT NULL,
    "car_id" INTEGER NOT NULL,
    "tax_invoice_sale_date" TIMESTAMP(3),
    "created_at" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "updated_at" TIMESTAMP(3) NOT NULL,
    "deleted_at" TIMESTAMP(3),

    CONSTRAINT "carTaxDetails_pkey" PRIMARY KEY ("id")
);

-- CreateTable
CREATE TABLE "CarPurchaseTaxInvoice" (
    "car_tax_details_id" INTEGER NOT NULL,
    "purchase_invoice_id" INTEGER NOT NULL,

    CONSTRAINT "CarPurchaseTaxInvoice_pkey" PRIMARY KEY ("car_tax_details_id","purchase_invoice_id")
);

-- CreateTable
CREATE TABLE "CarWithholdingTaxInvoice" (
    "car_tax_details_id" INTEGER NOT NULL,
    "withholding_invoice_id" INTEGER NOT NULL,

    CONSTRAINT "CarWithholdingTaxInvoice_pkey" PRIMARY KEY ("car_tax_details_id","withholding_invoice_id")
);

-- CreateTable
CREATE TABLE "CarSaleTaxInvoice" (
    "car_tax_details_id" INTEGER NOT NULL,
    "invoice_id" INTEGER NOT NULL,

    CONSTRAINT "CarSaleTaxInvoice_pkey" PRIMARY KEY ("car_tax_details_id","invoice_id")
);

-- CreateTable
CREATE TABLE "carDocumentTracking" (
    "id" SERIAL NOT NULL,
    "car_id" INTEGER NOT NULL,
    "fp_due_date" TIMESTAMP(3),
    "book_close_date" TIMESTAMP(3),
    "book_sent_to_bank_date" TIMESTAMP(3),
    "transfer_status" "transferStatus" DEFAULT 'pending',
    "book_record_date" TEXT,
    "installment_amount" DOUBLE PRECISION,
    "installment_number" INTEGER,
    "financing_id" INTEGER,
    "created_at" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "updated_at" TIMESTAMP(3) NOT NULL,
    "deleted_at" TIMESTAMP(3),

    CONSTRAINT "carDocumentTracking_pkey" PRIMARY KEY ("id")
);

-- CreateTable
CREATE TABLE "carAssociatedEntities" (
    "id" SERIAL NOT NULL,
    "car_id" INTEGER NOT NULL,
    "purchase_from_id" INTEGER,
    "customer_id" INTEGER,
    "salesperson_id" INTEGER,
    "created_at" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "updated_at" TIMESTAMP(3) NOT NULL,
    "deleted_at" TIMESTAMP(3),

    CONSTRAINT "carAssociatedEntities_pkey" PRIMARY KEY ("id")
);

-- CreateTable
CREATE TABLE "carGeneralInfo" (
    "id" SERIAL NOT NULL,
    "car_id" INTEGER NOT NULL,
    "fp_name" TEXT,
    "promotion_detail" TEXT,
    "tracking_note" TEXT,
    "note" TEXT,
    "car_image_link" TEXT,
    "car_release_date" TIMESTAMP(3),
    "day" INTEGER,
    "month" INTEGER,
    "year" INTEGER,
    "created_at" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "updated_at" TIMESTAMP(3) NOT NULL,
    "deleted_at" TIMESTAMP(3),

    CONSTRAINT "carGeneralInfo_pkey" PRIMARY KEY ("id")
);

-- AddForeignKey
ALTER TABLE "carFinancialDetails" ADD CONSTRAINT "carFinancialDetails_car_id_fkey" FOREIGN KEY ("car_id") REFERENCES "car"("car_id") ON DELETE RESTRICT ON UPDATE CASCADE;

-- AddForeignKey
ALTER TABLE "carExpenseDetails" ADD CONSTRAINT "carExpenseDetails_car_id_fkey" FOREIGN KEY ("car_id") REFERENCES "car"("car_id") ON DELETE RESTRICT ON UPDATE CASCADE;

-- AddForeignKey
ALTER TABLE "carApprovalDetails" ADD CONSTRAINT "carApprovalDetails_car_id_fkey" FOREIGN KEY ("car_id") REFERENCES "car"("car_id") ON DELETE RESTRICT ON UPDATE CASCADE;

-- AddForeignKey
ALTER TABLE "carLocationDetails" ADD CONSTRAINT "carLocationDetails_parking_id_fkey" FOREIGN KEY ("parking_id") REFERENCES "branch"("branch_id") ON DELETE RESTRICT ON UPDATE CASCADE;

-- AddForeignKey
ALTER TABLE "carLocationDetails" ADD CONSTRAINT "carLocationDetails_sale_branch_id_fkey" FOREIGN KEY ("sale_branch_id") REFERENCES "branch"("branch_id") ON DELETE SET NULL ON UPDATE CASCADE;

-- AddForeignKey
ALTER TABLE "carLocationDetails" ADD CONSTRAINT "carLocationDetails_branch_50_percent_id_fkey" FOREIGN KEY ("branch_50_percent_id") REFERENCES "branch"("branch_id") ON DELETE SET NULL ON UPDATE CASCADE;

-- AddForeignKey
ALTER TABLE "carLocationDetails" ADD CONSTRAINT "carLocationDetails_car_id_fkey" FOREIGN KEY ("car_id") REFERENCES "car"("car_id") ON DELETE RESTRICT ON UPDATE CASCADE;

-- AddForeignKey
ALTER TABLE "carTaxDetails" ADD CONSTRAINT "carTaxDetails_car_id_fkey" FOREIGN KEY ("car_id") REFERENCES "car"("car_id") ON DELETE RESTRICT ON UPDATE CASCADE;

-- AddForeignKey
ALTER TABLE "CarPurchaseTaxInvoice" ADD CONSTRAINT "CarPurchaseTaxInvoice_car_tax_details_id_fkey" FOREIGN KEY ("car_tax_details_id") REFERENCES "carTaxDetails"("id") ON DELETE RESTRICT ON UPDATE CASCADE;

-- AddForeignKey
ALTER TABLE "CarPurchaseTaxInvoice" ADD CONSTRAINT "CarPurchaseTaxInvoice_purchase_invoice_id_fkey" FOREIGN KEY ("purchase_invoice_id") REFERENCES "purchaseTaxInvoice"("purchase_invoice_id") ON DELETE RESTRICT ON UPDATE CASCADE;

-- AddForeignKey
ALTER TABLE "CarWithholdingTaxInvoice" ADD CONSTRAINT "CarWithholdingTaxInvoice_car_tax_details_id_fkey" FOREIGN KEY ("car_tax_details_id") REFERENCES "carTaxDetails"("id") ON DELETE RESTRICT ON UPDATE CASCADE;

-- AddForeignKey
ALTER TABLE "CarWithholdingTaxInvoice" ADD CONSTRAINT "CarWithholdingTaxInvoice_withholding_invoice_id_fkey" FOREIGN KEY ("withholding_invoice_id") REFERENCES "withholdingTaxInvoice"("withholding_invoice_id") ON DELETE RESTRICT ON UPDATE CASCADE;

-- AddForeignKey
ALTER TABLE "CarSaleTaxInvoice" ADD CONSTRAINT "CarSaleTaxInvoice_car_tax_details_id_fkey" FOREIGN KEY ("car_tax_details_id") REFERENCES "carTaxDetails"("id") ON DELETE RESTRICT ON UPDATE CASCADE;

-- AddForeignKey
ALTER TABLE "CarSaleTaxInvoice" ADD CONSTRAINT "CarSaleTaxInvoice_invoice_id_fkey" FOREIGN KEY ("invoice_id") REFERENCES "taxInvoice"("invoice_id") ON DELETE RESTRICT ON UPDATE CASCADE;

-- AddForeignKey
ALTER TABLE "carDocumentTracking" ADD CONSTRAINT "carDocumentTracking_financing_id_fkey" FOREIGN KEY ("financing_id") REFERENCES "customer"("customer_id") ON DELETE SET NULL ON UPDATE CASCADE;

-- AddForeignKey
ALTER TABLE "carDocumentTracking" ADD CONSTRAINT "carDocumentTracking_car_id_fkey" FOREIGN KEY ("car_id") REFERENCES "car"("car_id") ON DELETE RESTRICT ON UPDATE CASCADE;

-- AddForeignKey
ALTER TABLE "carAssociatedEntities" ADD CONSTRAINT "carAssociatedEntities_purchase_from_id_fkey" FOREIGN KEY ("purchase_from_id") REFERENCES "supplier"("supplier_id") ON DELETE SET NULL ON UPDATE CASCADE;

-- AddForeignKey
ALTER TABLE "carAssociatedEntities" ADD CONSTRAINT "carAssociatedEntities_customer_id_fkey" FOREIGN KEY ("customer_id") REFERENCES "customer"("customer_id") ON DELETE SET NULL ON UPDATE CASCADE;

-- AddForeignKey
ALTER TABLE "carAssociatedEntities" ADD CONSTRAINT "carAssociatedEntities_salesperson_id_fkey" FOREIGN KEY ("salesperson_id") REFERENCES "employee"("employee_id") ON DELETE SET NULL ON UPDATE CASCADE;

-- AddForeignKey
ALTER TABLE "carAssociatedEntities" ADD CONSTRAINT "carAssociatedEntities_car_id_fkey" FOREIGN KEY ("car_id") REFERENCES "car"("car_id") ON DELETE RESTRICT ON UPDATE CASCADE;

-- AddForeignKey
ALTER TABLE "carGeneralInfo" ADD CONSTRAINT "carGeneralInfo_car_id_fkey" FOREIGN KEY ("car_id") REFERENCES "car"("car_id") ON DELETE RESTRICT ON UPDATE CASCADE;
